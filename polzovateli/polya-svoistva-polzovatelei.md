# Поля (свойства) пользователей

Для работы с пользователями в JohnCMS используется класс **`\Johncms\Users\User()`**\
У пользователя есть различные свойства (поля).

## Основные свойства пользователя

Список основных свойств пользователя, которые есть в таблице users:

| Название поля          | Описание                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| ---------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| name                   | Логин пользователя                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| name\_lat              | Логин, но в нижнем регистре, латиницей                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| password               | Хэш пароля пользователя                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| rights                 | <p>Права пользователя. Может содержать одно из следующих значений:<br><strong>0</strong> - Обычный пользователь<br><strong>3</strong> - Модератор форума<br><strong>4</strong> - Модератор загрузок<br><strong>5</strong> - Модератор библиотеки<br><strong>6</strong> - Супермодератор<br><strong>7</strong> - Администратор<br><strong>9</strong> - Супервизор</p>                                                                                                                                                                                                                                                                                    |
| failed\_login          | Количество неудачных попыток авторизации                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| imname                 | Имя                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| sex                    | <p>Пол пользователя. Содержит одно из следующих значений:<br><strong>m</strong> - Мужчина<br><strong>zh</strong> - Женщина</p>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| komm                   | Количество комментариев                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| postforum              | Количество постов на форуме                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| postguest              | Количество постов в гостевой                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| yearofbirth            | Год рождения                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| datereg                | Дата регистрации (timestamp)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| lastdate               | Дата последнего визита (timestamp)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| mail                   | E-mail адрес                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| icq                    | ICQ (устаревшее)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| skype                  | Skype                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| jabber                 | Jabber (устаревшее)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| www                    | Сайт пользователя                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| about                  | О себе                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| live                   | Город, страна проживания                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| mibile                 | Номер телефона                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| status                 | Статус пользователя                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| ip                     | <p>IP адрес<br>В таблице хранится в преобразованном формате (ip2long).<br>Если вы получаете и записываете данные с помощью класса <strong>\Johncms\Users\User()</strong>, <strong></strong> вам не нужно заботиться о преобразовании.<br>Вы будете видеть IP в обычном формате. Все преобразования выполняются автоматически.</p>                                                                                                                                                                                                                                                                                                                       |
| ip\_via\_proxy         | <p>IP адрес за прокси (если удалось определить)<br>В таблице хранится в преобразованном формате (ip2long).<br>Если вы получаете и записываете данные с помощью класса <strong>\Johncms\Users\User()</strong>, <strong></strong> вам не нужно заботиться о преобразовании.<br>Вы будете видеть IP в обычном формате. Все преобразования выполняются автоматически.</p>                                                                                                                                                                                                                                                                                   |
| browser                | User Agent. Если используете модель **\Johncms\Users\User()**, то поле будет в безопасном для вывода виде. Дополнительно экранировать не требуется.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| preg                   | Пометка подтвержденного пользователя. Если поле запрашивается из модели, то оно будет содержать **boolean** значение (**true/false**). В таблице хранится число 0 или 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| regadm                 | Логин администратора, который подтвердил регистрацию пользователя                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| mailvis                | Пометка включенного отображения e-mail адреса в профиле. Если поле запрашивается из модели, то оно будет содержать **boolean** значение (**true/false**). В таблице хранится число 0 или 1                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| dayb                   | День рождения                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| monthb                 | Месяц рождения                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| sestime                | Текущее время активности пользователя (время активности сессии)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| total\_on\_site        | Сколько провёл на сайте (устаревшее и не используется).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| lastpost               | Время последнего поста (timestamp)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| rest\_code             | Код восстановления пароля                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| rest\_time             | Время восстановления пароля                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| movings                | Количество переходов по страницам в рамках текущей сессии.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| place                  | Местоположение пользователя                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| set\_user              | <p>Настройки пользователя.<br>При запросе этого поля из модели содержит объект класса <strong>Johncms\System\Users\UserConfig</strong><br>При записи через модель, принимает обычный массив и автоматически преобразует в нужный формат.<br>В таблице данные хранятся в сериализованном виде.<br><strong>Поля доступные в объекте:</strong><br><strong>directUrl</strong> - Прямые ссылки<br><strong>fieldHeight</strong> - Высота полей ввода<br><strong>kmess</strong> - Количество элементов на страницу<br><strong>lng</strong> - Выбранный язык<br><strong>timeshift</strong> - Сдвиг времени<br><strong>youtube</strong> - Youtube плеер<br> </p> |
| set\_forum             | Настройки форума. Массив с настройками форума. Может быть пустым, если пользователь не сохранял настройки.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| set\_mail              | Настройки почты. Массив с настройками почты. Может быть пустым, если пользователь не сохранял настройки.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| karma\_plus            | Количество положительных голосов в карме                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| karma\_minus           | Количество отрицательных голосов в карме                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| karma\_time            | Время голосования в карме                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| karma\_off             | Запрет кармы. Если поле запрашивается из модели, то оно будет содержать **boolean** значение (**true/false**). В таблице хранится число 0 или 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| comm\_count            | Количество комментариев                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| comm\_old              | Устаревшее, не используется                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| smileys                | Подборка смайлов пользователя. Массив. Может быть пустым, если пользователь не добавлял смайлы в подборку.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| notification\_settings | Настройки уведомлений. Массив с настройками уведомлений.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |

\
Модель **`\Johncms\Users\User()` ** в дополнение к основным полям возвращает дополнительные вычисленные поля.

## **Дополнительные свойства**

Список дополнительных свойств пользователя:

| Название поля               | Описание                                                                                                                                                                                                                                                                      |
| --------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| is\_online                  | Метка пользователя онлайн (**true/false**)                                                                                                                                                                                                                                    |
| rights\_name                | Название прав доступа текущего пользователя (для обычных пользователей пустая строка)                                                                                                                                                                                         |
| profile\_url                | Ссылка на страницу просмотра профиля пользователя                                                                                                                                                                                                                             |
| search\_ip\_url             | Ссылка на страницу поиска по ip                                                                                                                                                                                                                                               |
| whois\_ip\_url              | Ссылка на страницу whois ip                                                                                                                                                                                                                                                   |
| search\_ip\_via\_proxy\_url | Ссылка на страницу поиска по IP за прокси                                                                                                                                                                                                                                     |
| whois\_ip\_via\_proxy\_url  | Ссылка на страницу whois IP за прокси                                                                                                                                                                                                                                         |
| ban                         | Массив активных банов пользователя                                                                                                                                                                                                                                            |
| is\_valid                   | <p>Свойство используется при работе от текущего пользователя.<br><strong>true</strong> - если пользователь авторизован и подтвержден.<br><strong>false</strong> - если пользователь не авторизован или не подтвержден.</p>                                                    |
| is\_birthday                | <p><strong>true</strong> - если у пользователя день рождения.<br><strong>false</strong> - если нет.</p>                                                                                                                                                                       |
| birthday\_date              | Т.к. дата рождения в таблице users хранится в отдельных полях, то при запросе этого свойства она собирается в одну строку.                                                                                                                                                    |
| display\_place              | Местоположение пользователя для отображения. Содержит html код ссылки на страницу.                                                                                                                                                                                            |
| formatted\_about            | Обработанное поле "О себе". bb-коды преобразованы в html код.                                                                                                                                                                                                                 |
| website                     | Обработанное поле "Сайт". bb-коды преобразованы в html код.                                                                                                                                                                                                                   |
| last\_visit                 | <p>Дата последнего визита в человекопонятном виде.<br>Обратите внимание, если пользователь сейчас онлайн, это свойство будет пустым.</p>                                                                                                                                      |
| photo                       | <p>Фотография пользователя.<br>Если фотографии нет, возвращает пустой массив.<br>Если фотография есть, возвращает массив со ссылками на фото:<br><strong>photo</strong> - Большая фотография.<br><strong>photo_preview</strong> - Маленькая фотография для предпросмотра.</p> |
